(this["webpackJsonpkindergarten-helper"]=this["webpackJsonpkindergarten-helper"]||[]).push([[0],{53:function(t,e){},71:function(t,e,n){},80:function(t,e){},81:function(t,e){},82:function(t,e,n){"use strict";n.r(e);var a=n(18),c=n(4),r=n(0),o=n.n(r),i=n(10),s=n.n(i),u=(n(71),n(13)),l=n(37),d=n(38),p=n(116),h=n(120),f=n(121),b=n(84),j=n(122),m=n(127),v=Object(p.a)({root:{position:"absolute",right:"16px",top:"20px"}}),x=function(t){var e=t.value,n=t.successLabel,a=t.failureLabel,r=v(),o=e?"primary":"secondary",i=e?"default":"outlined",s=e?n:a;return Object(c.jsx)(m.a,{className:r.root,variant:i,size:"small",color:o,label:s})},y=Object(p.a)({root:{position:"relative",minWidth:"300px",maxWidth:"420px",margin:"8px",display:"flex","flex-direction":"column"},title:{"margin-bottom":"4px"},content:{display:"flex","flex-direction":"column"},actions:{padding:"0 16px 16px 16px","justify-content":"flex-end"}}),O=function(t){var e=t.title,n=t.text,a=t.completed,r=t.actions,o=t.content,i=y();return Object(c.jsxs)(h.a,{className:i.root,children:[Object(c.jsxs)(f.a,{className:i.content,children:[void 0!==a&&Object(c.jsx)(x,{value:a,successLabel:"Completed",failureLabel:"Not completed"}),Object(c.jsx)(b.a,{variant:"h6",className:i.title,children:e}),Object(c.jsx)(b.a,{variant:"body2",color:"textSecondary",component:"p",children:n}),o]}),Object(c.jsx)(j.a,{className:i.actions,children:r})]})},g=n(125),S=n(6),w=Object(S.a)({root:{"margin-top":"12px"}})(g.a),D=function(t){var e=t.label,n=t.value,a=t.onChange;return Object(c.jsx)(w,{label:e,multiline:!0,rows:4,variant:"outlined",value:n,onChange:a})},k=n(123),C=Object(p.a)({root:{"margin-top":"12px"}}),_=function(t){var e=t.file,n=t.setFile,a=Object(r.useRef)(null),o=C();return Object(c.jsxs)(k.a,{className:o.root,variant:"outlined",color:"secondary",component:"label",children:[e?e.name:"Upload table",Object(c.jsx)("input",{type:"file",onChange:function(){var t=a.current.files[0];n(t||null)},ref:a,hidden:!0})]})},F=n(61),T=function(t){var e=t.importance,n=t.children,r=Object(F.a)(t,["importance","children"]),o="primary"===e?"contained":"secondary"===e?"outlined":"text";return Object(c.jsx)(k.a,Object(a.a)(Object(a.a)({variant:o,color:"primary"},r),{},{children:n}))},$=n(42),N=n.n($),P=n(57),I=n(32),M=n.n(I),E=function(t,e,n){var a="very_long_input_id",c=M()("<button>!</button>");c.click((function(){var c=M()('<textarea id="'.concat(a,'">'));c.val(t),M()("body").append(c),c.focus(),c.select(),document.execCommand("copy")?e.success(n||"Everything is copied successfully"):e.error("Something is very wrong")}));var r=document.documentElement.scrollTop;c.click(),M()("#".concat(a)).remove(),document.documentElement.scrollTop=r},L=function(t,e){for(var n=t;n.length<e;)n="0"+n;return n},A=function(){var t=Object(P.a)(N.a.mark((function t(e){return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsBinaryString(e)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),B=n(43),G=n(12),J=function(t){var e=t.tableData,n=t.setTableData,a=Object(G.c)(),i=Object(r.useState)(null),s=Object(u.a)(i,2),l=s[0],d=s[1],p=Object(r.useState)(""),h=Object(u.a)(p,2),f=h[0],b=h[1];return Object(c.jsx)(O,{title:"Step 1",text:'Select a table file to use as a data source or copy and paste the .csv file contents into the text area and then press the "Submit" button to read the children data.',completed:!!e,content:!e&&Object(c.jsxs)(o.a.Fragment,{children:[Object(c.jsx)(_,{file:l,setFile:d}),Object(c.jsx)(D,{label:".csv contents",value:f,onChange:function(t){b(t.target.value)}})]}),actions:!e&&Object(c.jsx)(T,{importance:"primary",type:"submit",onClick:function(){l||""!==f?(l?function(t){return A(t).then((function(t){var e=Object(B.read)(t,{type:"binary"});return B.utils.sheet_to_csv(e.Sheets[e.SheetNames[0]])}))}(l):Promise.resolve(f)).then((function(t){return n(function(t){var e=/^[0-9]+,[\u0430-\u044f\u0410-\u044f]+ [\u0430-\u044f\u0410-\u044f]+,.*$/,n=/^[\u0430-\u044f\u0410-\u044f]+ [\u0430-\u044f\u0410-\u044f]\. [\u0430-\u044f\u0410-\u044f]\.,.*$/,a=!0,c=t.split("\n").map((function(t){return t.trim()})),r=c.filter((function(t){return e.test(t)}));0===r.length&&(r=c.filter((function(t){return n.test(t)})),a=!1);for(var o=r.reduce((function(t,e){var n=e.split(","),c=n[a?1:0];return t.children.push(c),t.days.push(function(t,e){var n=e?3:2;return function(t,e){for(var n=[],a=0;-1!==(a=t.indexOf(e,a+1));)n.push(a);return n}(t,"\u043d\u043d").map((function(t){return t-n}))}(n,a)),t}),{children:[],days:[]}),i=o.children,s=o.days,u={},l=function(t){var e=i[t];s[t].forEach((function(t){u[t]||(u[t]=[]),u[t].push(e)}))},d=0;d<i.length;++d)l(d);return{children:i,absentData:u}}(t))})):a.error("Select a workbook file for conversion or fill the text area with the .csv data. Why the fuck didn't you do this?")},children:"Submit"})})},W=function(t){var e=t.parsedData,n=t.setParsedData,a=Object(G.c)(),i=Object(r.useState)(""),s=Object(u.a)(i,2),l=s[0],d=s[1];return Object(c.jsx)(O,{title:"Step 2",text:'Press the "Get Function" button to copy the code to your clipboard. Paste and execute the code on the page with the children list to get the data.',completed:!!e,content:!e&&Object(c.jsx)(D,{value:l,label:"Function result",onChange:function(t){d(t.target.value)}}),actions:!e&&Object(c.jsxs)(o.a.Fragment,{children:[Object(c.jsx)(T,{importance:"secondary",type:"button",onClick:function(){E("(function() {\n    const children = Array.from($('.j_tr')).slice(1, -1).map(row => {\n        const cells = Array.from($(row).children('td'))\n        const name = cells[1].innerText\n        const id = cells[2].getAttribute('child')\n\n        return {id, name}\n    }).reduce((res, child) => {\n        res[child.name + '_' + child.id] = child.id\n        return res\n    }, {})\n    \n    const groupId = $('#id_group')[0].value\n    const dou_id = $('[name=\"dou_id\"]')[0].value\n    const month = $('#id_period')[0].value\n    const year = $('#id_year')[0].value\n    const lastDay = $('#table tbody tr').first().children().length - 4\n    \n    const data = {children, groupId, dou_id, month, year, lastDay}\n\n    const copyToClipboard = (value) => {\n        const button = $('<button>!</button>')\n        button.click(() => {\n            const input = $('<input id=\"ultra_input\">')\n            input.val(value)\n\n            $('body').append(input)\n            input.focus()\n            input.select()\n\n            const res = document.execCommand('copy')\n            if (res) {\n                alert('Names and ids were copied successfully')\n            } else {\n                alert('Something went very wrong')\n            }\n\n        })\n        button.click()\n\n        $('#ultra_input').remove()\n    }\n    \n    copyToClipboard(JSON.stringify(data))\n})()",a,"The function was copied successfully.")},children:"Get Function"}),Object(c.jsx)(T,{importance:"primary",type:"submit",onClick:function(){""!==l?n(JSON.parse(l)):a.error("The area you should have filled with the scrapped children data is empty. The fuck?")},children:"Submit"})]})})},z=function(t){var e=t.parsedData,n=t.tableData,a=t.successfulMatches,i=t.setSuccessfulMatches,s=Object(G.c)(),l=Object(r.useState)([]),d=Object(u.a)(l,2),p=d[0],h=d[1];return Object(c.jsx)(O,{title:"Step 3",text:"Map children from the .csv to the scrapped children from the web page.",completed:!!a,content:!!p.length&&Object(c.jsxs)(o.a.Fragment,{children:[Object(c.jsx)(b.a,{variant:"h6",children:"Failed to match"}),Object(c.jsx)(b.a,{variant:"body2",color:"textSecondary",component:"p",children:p.join("\n")})]}),actions:!a&&Object(c.jsx)(T,{importance:"primary",type:"submit",onClick:function(){if(e&&n){var t=function(t,e){for(var n=Object.keys(t),a=n.map((function(t){var e=t.match(/^(.+) .\. .\._.*$/);return e&&e[1]?e[1]:t})),c=e.map((function(t){return t.split(" ")[0]})).map((function(e){var c=a.indexOf(e);return-1===c?null:(a[c]="",t[n[c]])})),r=[],o=new Map,i=0;i<c.length;++i){var s=e[i],u=c[i];u?o.set(s,u):r.push(s)}return{failures:r,matchedIds:o}}(e.children,n.children),a=t.failures,c=t.matchedIds;i(c),h(a)}else s.error("You should complete the first two steps before you are able to do that. The fuck are you thinking?")},children:"Submit"})})},R=function(t){var e=t.parsedData,n=t.tableData,a=t.successfulMatches,r=Object(G.c)();return Object(c.jsx)(O,{title:"Step 4",text:'Press the "Get Function" button to copy the code to your clipboard. Paste and execute the code on the page with the children list to set the data from the .csv.',actions:Object(c.jsx)(T,{importance:"primary",type:"button",onClick:function(){if(a){var t=new Map;for(var c in n.absentData)t.set(c,n.absentData[c].map((function(t){return a.get(t)})).filter((function(t){return!!t})));var o=function(t,e,n,a,c,r){var o="position: fixed;\n                        background: #FFC0CBaa;\n                        top: 0;\n                        bottom: 0;\n                        left: 0;\n                        right: 0;\n                        display: flex;\n                        justify-content: center;\n                        align-items: center;".split("\n").map((function(t){return t.trim()})).join(""),i="color: #fff;\n                        font-weight: bold;\n                        font-size: 26px;\n                        background: #3333;\n                        border-radius: 8px;\n                        padding: 4px;".split("\n").map((function(t){return t.trim()})).join(""),s=function(t,e){for(var n=[],a=0;a<e;++a)n.push(a);return n}(0,r+1).map((function(r){var o=L(""+r,2),i=L(a,2),s="".concat(o,".").concat(i,".").concat(c),u=t.get(""+r)||[];return"fixDay('".concat(n,"', '").concat(u.join("|"),"', '").concat(e,"', '").concat(s,"')")})).join(",\n");return"\n    (function() {\n        let completed = ".concat(r,"\n        if (completed > 0) {\n            ").concat("\nfunction fixDay(dou_id, childrenIds, groupId, dateStr) {\n    return new Promise(resolve => {\n        $.post('/cabinet/children/visit/save/?dou_id=' + dou_id, {\n            children: childrenIds,\n            group: groupId,\n            date: dateStr\n        }, (data) => {\n            resolve(data)\n        });\n    })\n}\n","\n        \n            let cover = $('<div style=\"").concat(o,'"><div style="').concat(i,"\">\u0429\u0430, \u0449\u0430, \u043f\u043e\u0433\u043e\u0434\u0438.</div></div>')\n            $('body').append(cover)\n            \n            Promise.all(").concat(s,").then(() => {\n                cover.remove()\n            })\n        }\n    })()\n    ")}(t,e.groupId,e.dou_id,e.month,e.year,e.lastDay);E(o,r,"The function was copied successfully.")}else r.error("No matched data. Did you do the steps 1-3? The fuck are you thinking?")},children:"Get Function"})})};function U(){var t=Object(l.a)(["\n  font-size: 32px;\n  font-weight: bold;\n  margin: 20px auto;\n"]);return U=function(){return t},t}function H(){var t=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: start;\n  flex-wrap: wrap;\n"]);return H=function(){return t},t}function Y(){var t=Object(l.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin: 0 auto;\n"]);return Y=function(){return t},t}var q=d.a.div(Y()),K=d.a.div(H()),Q=d.a.div(U()),V=function(){var t=Object(r.useState)(null),e=Object(u.a)(t,2),n=e[0],a=e[1],o=Object(r.useState)(null),i=Object(u.a)(o,2),s=i[0],l=i[1],d=Object(r.useState)(null),p=Object(u.a)(d,2),h=p[0],f=p[1];return Object(c.jsxs)(q,{children:[Object(c.jsx)(Q,{children:"Ultra Helper"}),Object(c.jsxs)(K,{children:[Object(c.jsx)(J,{tableData:n,setTableData:a}),Object(c.jsx)(W,{parsedData:s,setParsedData:l}),Object(c.jsx)(z,{parsedData:s,tableData:n,successfulMatches:h,setSuccessfulMatches:f}),Object(c.jsx)(R,{parsedData:s,tableData:n,successfulMatches:h})]})]})},X=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,129)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,r=e.getLCP,o=e.getTTFB;n(t),a(t),c(t),r(t),o(t)}))},Z=n(126),tt=n(124),et={width:"500px",margin:"4px",maxWidth:"100vw"},nt=function(t){var e=t.message,n=t.options,r="error"===n.type?"Error":"success"===n.type?"Success":"Info";return Object(c.jsxs)(Z.a,{style:Object(a.a)({},et),severity:n.type,children:[Object(c.jsx)(tt.a,{children:r}),e]})},at={position:G.b.TOP_CENTER,timeout:5e3};s.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(G.a,Object(a.a)(Object(a.a)({template:nt},at),{},{children:Object(c.jsx)(V,{})}))}),document.getElementById("root")),X()}},[[82,1,2]]]);
//# sourceMappingURL=main.a96204e5.chunk.js.map